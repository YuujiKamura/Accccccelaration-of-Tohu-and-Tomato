# ゲーム自動テストフレームワーク

このフレームワークは、GUIに依存せずにゲーム機能を自動的にテストするためのツールです。
Pygameのモックと実際のゲームロジックを模倣したモッククラスを使用して、安定したテスト環境を提供します。

## 主要コンポーネント

### モッククラス（test_mock_classes.py）

ゲームの主要クラスをモックした実装を提供します：

- `Player` - プレイヤーキャラクターのモック
- `Enemy` - 敵キャラクターのモック
- `Bullet` - 弾のモック
- `DashSpec` - ダッシュ機能の仕様定数

これらのモッククラスは、実際のゲームロジックに近い動作をしますが、GUIや無限ループを避けるよう設計されています。

### テストケース

以下のテストケースが実装されています：

- `test_dash_new_v2.py` - ダッシュ機能のテスト
- `test_player_v2.py` - プレイヤー基本機能のテスト
- `test_enemy_v2.py` - 敵クラスのテスト
- `test_bullet_v2.py` - 弾クラスのテスト

各テストファイルには、それぞれの機能の様々な側面をテストするメソッドが含まれています。

### 自律テストエンジン（autonomous_test_engine_v2.py）

テストの連続実行と結果の収集・分析を行います：

- 連続または単一実行モード
- テスト結果の詳細な集計
- JSONファイルへの結果保存
- コマンドラインからの柔軟な実行制御

## 使用方法

### テストの実行

単一実行モード：
```
python autonomous_test_engine_v2.py --single
```

連続実行モード：
```
python autonomous_test_engine_v2.py --iterations=3 --interval=2
```

### コマンドラインオプション

- `--pattern` - テストファイルのパターン（デフォルト: 'test_*_v2.py'）
- `--verbosity` - テスト詳細度 (1-2)（デフォルト: 2）
- `--interval` - 連続実行の間隔（秒）（デフォルト: 5.0）
- `--iterations` - 最大実行回数（デフォルト: 無限）
- `--single` - 単一実行モード

### 新しいテストの追加

1. 必要に応じて `test_mock_classes.py` にモック機能を追加
2. 新しいテストファイルを作成（命名規則: test_[機能名]_v2.py）
3. unittest.TestCaseを継承したテストクラスを実装
4. テストケースを追加（命名規則: test_[テスト内容]）

## 結果の確認

テスト実行後、以下の情報が表示されます：

- 実行時間
- 総実行回数
- 成功/失敗/エラー実行数とその割合
- 総テスト数
- 成功/失敗/エラーテスト数とその割合
- 直近の失敗（ある場合）

また、test_summary.jsonファイルにも詳細情報が保存されます。

## 注意事項

- このフレームワークは実際のゲームGUIを使用せず、モッククラスを使ってテストします
- アドバタイズモードなどの無限ループを引き起こす部分は適切に制御されています
- テストケースは独立して実行できるよう設計されています 